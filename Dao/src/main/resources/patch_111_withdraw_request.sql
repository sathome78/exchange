ALTER TABLE WITHDRAW_REQUEST
	ADD COLUMN currency_id INT(11) NULL DEFAULT NULL,
	ADD COLUMN user_id INT(11) NULL DEFAULT NULL,
	ADD COLUMN commission_id INT(11) NULL DEFAULT NULL,
	ADD COLUMN merchant_id INT(11) NULL DEFAULT NULL,
	ADD COLUMN admin_holder_id INT(11) NULL DEFAULT NULL;

ALTER TABLE WITHDRAW_REQUEST
	ADD CONSTRAINT FK_withdraw_request_currency FOREIGN KEY (currency_id) REFERENCES CURRENCY (id);

ALTER TABLE WITHDRAW_REQUEST
	ADD CONSTRAINT FK_withdraw_request_merchant FOREIGN KEY (merchant_id) REFERENCES MERCHANT (id);

ALTER TABLE WITHDRAW_REQUEST
	ADD CONSTRAINT FK_withdraw_request_user FOREIGN KEY (user_id) REFERENCES USER (id);

ALTER TABLE WITHDRAW_REQUEST
	ADD CONSTRAINT FK_withdraw_request_commission FOREIGN KEY (commission_id) REFERENCES COMMISSION (id);

ALTER TABLE WITHDRAW_REQUEST
	ADD CONSTRAINT FK_withdraw_request_admin_holder FOREIGN KEY (admin_holder_id) REFERENCES USER (id);

ALTER TABLE WITHDRAW_REQUEST
	CHANGE COLUMN acceptance acceptance TIMESTAMP NULL DEFAULT NULL;

INSERT INTO USER_COMMENT_TOPIC (topic) VALUES ('WITHDRAW_DECLINE');
INSERT INTO USER_COMMENT_TOPIC (topic) VALUES ('WITHDRAW_POSTED');

INSERT INTO PHRASE_TEMPLATE (template, topic_id) VALUES ('withdrawal.phrases.decline.1', 4);
INSERT INTO PHRASE_TEMPLATE (template, topic_id) VALUES ('withdrawal.phrases.decline.2', 4);
INSERT INTO PHRASE_TEMPLATE (template, topic_id) VALUES ('withdrawal.phrases.decline.3', 4);

ALTER TABLE TRANSACTION
	ADD COLUMN description VARCHAR(100) NULL;
	
ALTER TABLE USER_CURRENCY_INVOICE_OPERATION_PERMISSION
	DROP INDEX user_id_currency_id_operation_direction,
	ADD UNIQUE INDEX user_id_currency_id_operation_direction (user_id, currency_id, operation_direction);

ALTER TABLE MERCHANT
	ADD COLUMN service_bean_name VARCHAR(100) NULL;

INSERT INTO WITHDRAW_REQUEST_STATUS (id, name) VALUES (11, 'IN_POSTING');

INSERT INTO USER (id, nickname, email, password, roleid) VALUES ('-1', 'SYSTEM', 'SYSTEM', 'inapplicable', '1');


